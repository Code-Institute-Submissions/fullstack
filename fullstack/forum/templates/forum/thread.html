{% extends 'forum/forum.html' %}
{% load thread_extras %}
{% load staticfiles %}
{% block forum_subtitle %}
    <div class="row no-gutters">
        <h2>{{ thread.name }}</h2>
    </div>
    <div class="row no-gutters">
        <a class="btn btn-subhero btn-subhero--forum" href="{% url 'forum' %}">All Forums</a>
        {% if user.is_authenticated %}
        <a class="btn btn-subhero btn-subhero--forum" href="{% url 'new_post' thread.id %}">New Post</a>
        {% endif %}
    </div>
{% endblock %}
{% block forum %}
{#<section class="forum-intro">#}
{#    <div class="row no-gutters align-items-center">#}
{#        <div class="col">#}
{#            <div class="post-created">Created: <span><time datetime="{{ thread.created_at }}"> {{ thread.created_at | started_time }} </time></span></div>#}
{#            <div class="post-owner">Created by: <span>{{ thread.user.username }}</span></div>#}
{#            <div class="last-post">Last Post: {% last_posted_user_name thread %}</div>#}
{#        </div>#}
{#    </div>#}
{#</section>#}
<section class="forum-section--main post-list">
    <div class="thread-info-container flex-column flex-lg-row row no-gutters justify-content-center align-items-center">
        <div class="thread-info post-created">Thread Created: <strong><span><time datetime="{{ thread.created_at }}"> {{ thread.created_at | started_time }} </time></span></strong></div>
        <div class="thread-info post-owner">Created by: <strong><span>{{ thread.user.username }}</span></strong></div>
        <div class="thread-info last-post">Last Post: <strong>{% last_posted_user_name thread %}</strong></div>
    </div>
    {% if thread.poll %}
    <div class="poll-section">
        <div class="container">
            <div class="col-md-6">
                <h2>Poll</h2>
                <strong>{{ thread.poll.question }}</strong><br /><br />
                <p>Here's how the votes are so far:</p>
                {% for subject in thread.poll.subjects.all %}
                    <div class="col-md-10">
                        <strong>{{ subject.name }}</strong>
                        <span class="fa-pull-right">{{ subject | vote_percentage }}%</span>
                    </div>
                    {% autoescape off %}
                        {% user_vote_button thread subject user %}
                    {% endautoescape %}
                    <div class="col-md-10">
                        <div class="progress">
                            <div class="progress-bar progress-bar-info" role="progressbar"
                                 aria-value="{{ subject | vote_percentage }}" aria-valuemin="0"
                                 aria-valuemax="100" style="width: {{ subject | vote_percentage }}%;">
                            </div>
                        </div>
                    </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}
    {% for post in thread.posts.all %}
    {% include "forum/post.html" %}
    {% endfor %}
    <div class="new-post-section">
        {% if user.is_authenticated %}
        <a href="{% url 'new_post' thread.id %}" class="btn admin-btn">New Post</a>
        {% else %}
        <div class="login-required-container d-flex flex-column justify-content-center align-items-center">
            <div class="login-required-title">
                <strong>Looking to contribute to this thread?</strong>
            </div>
            <div class="login-required-info">
                You must be logged in to reply to this thread. Click on one of the links below to login or register.
            </div>
            <div class="login-required-cta d-flex flex-column flex-sm-row justify-content-around align-items-center">
                <a class="login-required-cta--button" href="{% url 'register'%}"><i class="fas fa-user-plus"></i> Register</a>
                <a class="login-required-cta--button" href="{% url 'login'%}"><i class="fas fa-sign-in-alt"></i> Log in</a>
            </div>
        </div>
        {% endif %}
    </div>
</section>
{% endblock %}